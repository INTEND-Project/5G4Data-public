{
    auto_https off
}

start5g-1.cs.uit.no:443 {
    tls /etc/ssl/certs/fullchain.pem /etc/ssl/certs/privkey.pem

    # Main Flask app at root
    handle {
        reverse_proxy flask-app:5003
    }

    # Workload catalog legacy path
    handle /webapp/* {
        reverse_proxy http://webapp:3000
    }

    # Workload catalog at /workloads
    handle /workloads/* {
        uri replace /workloads /webapp
        reverse_proxy http://webapp:3000
    }

    # ChartMuseum at /charts
    handle /charts/* {
        uri strip_prefix /charts
        reverse_proxy http://chartmuseum:8080
    }
}